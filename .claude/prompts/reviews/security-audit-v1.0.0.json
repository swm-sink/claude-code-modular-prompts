{
  "id": "security-audit-comprehensive",
  "version": "1.0.0",
  "category": "reviews",
  "name": "Comprehensive Security Audit",
  "description": "Performs thorough security analysis including OWASP Top 10, authentication, and data protection",
  "prompt": {
    "template": "Perform a comprehensive security audit of {{target_type}} {{target_path}}:\n\n## Security Audit Scope\n\n### 1. OWASP Top 10 Analysis\nSystematically check for:\n- Injection vulnerabilities (SQL, NoSQL, Command, LDAP)\n- Broken authentication and session management\n- Sensitive data exposure\n- XML External Entities (XXE)\n- Broken access control\n- Security misconfiguration\n- Cross-Site Scripting (XSS)\n- Insecure deserialization\n- Using components with known vulnerabilities\n- Insufficient logging and monitoring\n\n### 2. Authentication & Authorization\n- Review authentication mechanisms\n- Analyze authorization controls\n- Check for privilege escalation paths\n- Validate session management\n- Review password policies and storage\n\n### 3. Data Protection\n- Identify sensitive data handling\n- Check encryption at rest and in transit\n- Review data retention and deletion\n- Analyze PII handling compliance\n{{#if compliance_standards}}\n- Verify compliance with: {{#each compliance_standards}}{{this}} {{/each}}\n{{/if}}\n\n### 4. Input Validation & Output Encoding\n- Review all input validation\n- Check for proper output encoding\n- Identify trust boundaries\n- Analyze data flow security\n\n### 5. Security Headers & Configuration\n- Review security headers implementation\n- Check CORS configuration\n- Analyze CSP policies\n- Review TLS/SSL configuration\n\n{{#if specific_concerns}}\n### 6. Specific Security Concerns\n{{#each specific_concerns}}\n- {{this}}\n{{/each}}\n{{/if}}\n\n### 7. Third-Party Dependencies\n- Scan for known vulnerabilities\n- Review dependency update practices\n- Check for outdated libraries\n\n### Deliverables\n1. **Critical Findings**: Immediate action required\n2. **High Priority**: Address within {{high_priority_timeline}}\n3. **Medium Priority**: Address within {{medium_priority_timeline}}\n4. **Low Priority**: Best practice improvements\n5. **Remediation Guide**: Step-by-step fixes for each finding\n\n{{#if include_penetration_test}}\n### 8. Penetration Testing Scenarios\nInclude proof-of-concept for critical vulnerabilities (ethical guidelines apply)\n{{/if}}\n\nProvide specific code examples and remediation steps for each finding.",
    "variables": [
      {
        "name": "target_type",
        "description": "Type of target being audited",
        "type": "string",
        "required": true,
        "examples": ["application", "API", "infrastructure", "codebase"]
      },
      {
        "name": "target_path",
        "description": "Path or identifier for the audit target",
        "type": "string",
        "required": true
      },
      {
        "name": "compliance_standards",
        "description": "Compliance standards to check against",
        "type": "array",
        "required": false,
        "examples": [["GDPR", "HIPAA", "PCI-DSS", "SOC2"]]
      },
      {
        "name": "specific_concerns",
        "description": "Specific security concerns to investigate",
        "type": "array",
        "required": false
      },
      {
        "name": "high_priority_timeline",
        "description": "Timeline for high priority fixes",
        "type": "string",
        "required": true,
        "default": "48 hours"
      },
      {
        "name": "medium_priority_timeline",
        "description": "Timeline for medium priority fixes",
        "type": "string",
        "required": true,
        "default": "1 week"
      },
      {
        "name": "include_penetration_test",
        "description": "Include penetration testing scenarios",
        "type": "boolean",
        "required": false,
        "default": false
      }
    ]
  },
  "metadata": {
    "created": "2024-01-06T00:00:00Z",
    "updated": "2024-01-06T00:00:00Z",
    "author": "system",
    "tags": ["security", "audit", "owasp", "compliance", "penetration-testing"],
    "dependencies": ["security-scanning-tools"]
  },
  "performance": {
    "estimatedTokens": 1500,
    "complexity": "high",
    "timeout": 120
  },
  "validation": {
    "outputFormat": "markdown",
    "successCriteria": [
      "Complete OWASP Top 10 coverage",
      "Actionable remediation steps",
      "Priority-based findings",
      "Code examples for fixes"
    ]
  }
}